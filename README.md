
# GitHub Actions: Code Check Workflow

このリポジトリでは、PHPコードとJavaScriptコードの品質チェックを自動化するためのGitHub Actionsワークフローを設定しています。このワークフローは、プルリクエストの作成や更新時に自動的に実行されます。

---

## **ワークフローの概要**

このワークフローでは、以下のタスクを実行します。

1. **PHPコードのスタイルチェック**:
    - **PHP CodeSniffer (PHPCS)** を使用して、PHPコードが [PSR-12 標準](https://www.php-fig.org/psr/psr-12/) に準拠しているかを確認します。
2. **JavaScriptコードの静的解析**:
    - **ESLint** を使用して、JavaScriptコードの品質とスタイルをチェックします。
3. **エラーのまとめ**:
    - PHPとJavaScriptの両方のチェック結果をまとめてログに出力します。

---

## **ワークフローの動作**

以下は、このワークフローのステップごとの説明です。

### **1. トリガー**
- プルリクエストが作成または更新されたときに自動的に実行されます。

### **2. 環境セットアップ**
- **リポジトリのクローン**:
  リポジトリのコードをGitHub Actionsのランナーにチェックアウトします。
- **完全な履歴を取得**:
  差分を正確に取得するために、Gitの完全な履歴をフェッチします。

### **3. PHPコードチェック**
- **PHP環境のセットアップ**:
    - PHPのバージョンは `8.1` を使用します。
    - Composer（PHPのパッケージ管理ツール）をセットアップします。
- **依存関係のインストール**:
  Composerを使用して、必要なライブラリ（例: `phpcs`）をインストールします。
- **変更されたPHPファイルの取得**:
  Gitの差分を使用して、現在のプルリクエストで変更されたPHPファイルのみを対象にします。
- **PHPCSでコードスタイルチェック**:
  PHPCSを使用して、PHPコードがPSR-12標準に準拠しているかをチェックします。

### **4. JavaScriptコードチェック**
- **Node.js環境のセットアップ**:
    - Node.jsのバージョンは `18` を使用します。
    - npm（Node.jsのパッケージ管理ツール）をセットアップします。
- **依存関係のインストール**:
  npmを使用して、必要なライブラリ（例: `eslint`）をインストールします。
- **変更されたJavaScriptファイルの取得**:
  Gitの差分を使用して、現在のプルリクエストで変更されたJavaScriptファイルのみを対象にします。
- **ESLintでコードチェック**:
  ESLintを使用して、JavaScriptコードの品質やスタイルをチェックします。

### **5. エラーのまとめと表示**
- PHPとJavaScriptのチェック結果をまとめて表示します。
- エラーが検出された場合、ワークフローは失敗として終了します。

## **キャッシュについて**

ワークフローでは、PHPおよびJavaScript依存関係を効率的にインストールするためにキャッシュを使用しています。

- **Composer（PHP依存関係）**:
    - `composer.lock` の変更を検知してキャッシュを更新します。
- **npm（JavaScript依存関係）**:
    - `package-lock.json` の変更を検知してキャッシュを更新します。

キャッシュにより、インストール時間が大幅に短縮されます。

---

このワークフローにより、コードレビュー時の品質チェックが効率化され、チーム全体でコードスタイルや品質を統一できます。
